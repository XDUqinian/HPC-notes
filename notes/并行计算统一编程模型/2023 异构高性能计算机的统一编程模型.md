# 2023 异构高性能计算机的统一编程模型

## 内容概括

**现有并行计算统一编程模型存在的问题？ 没有做到性能可移植性**

随着摩尔定律和登纳德缩放定律的发展放缓，现有的高性能计算机大多基于异构实现。为了充分利用异构系统的性能，硬件开发商们开发了专属加速工具包，但是不同硬件的编程是不一样的，因此存在着代码可移植性问题。在众多研究者的努力下，现有的许多并行计算统一编程模型已经实现了异构系统的代码可移植性，使得同一个程序能在异构系统上使用相同的语法实现。然而，这些现有的模型却没有实现性能可移植性，还不能使得同样的程序在不同架构上实现相同的计算效率，性能可移植性被 Pennycook 定义为在不同计算机上使用运行特定的应用解决同一个问题的效率的调和平均数。已有的并行计算统一编程模型更多在考虑底层硬件系统，而忽略了高层应用的描述，而这就导致模型无法针对上层应用对程序进行特定优化，同时，它们也不能够将上层应用相关的优化传递到底层架构上，因此这些编程模型达不到令人满意的性能可移植性。

**做到性能可移植性要解决哪些问题？**

首先，模型需要能基于不同上层应用的工作特征对程序进行领域相关的优化。

其次，模型需要能够基于不同底层硬件架构的特征对程序进行架构相关的优化。

最后，模型需要解除上层应用优化与下层架构优化的耦合。

**如何解决上述问题？**

四个方面：编程语言、编程抽象、编译优化、调度系统。

在编程语言上，我们可以设计许多针对不同领域的领域特定语言，使得领域特定的工作特征与计算模式能够被准确地表示。

在编程抽象上，我们设计一个统一的编程抽象模型，将领域特定语言映射到统一的编程抽象上，使模型既能准确表示上层应用特征，又能向下层硬件结构优化。同时，统一的编程抽象支持上层领域的可扩展性，未来出现的新领域只需要设计新的领域特定语言与映射即可。

在编译优化上，我们提出多级编译优化，将编译过程分成几个阶段，每个阶段进行特定的优化，在上层可以针对应用特征做优化，在底层可以针对架构做优化，以达到全面的性能优化。

在调度系统上，我们设计资源感知轻量级运行时调度系统，它需要有效分析并行程序之间的计算依赖关系，从而自动发现任务内和任务间的并行性，探索并发执行的机会。同时，它也需要合理分配有限的计算资源，分析不同任务的计算需求，达到高效的并行任务调度。

<img src="../../imgs/2023 异构高性能计算机的统一编程模型/1.jpg" alt="../imgs/2023 异构高性能计算机的统一编程模型/1.jpg" style="zoom: 50%;" />

## 思考

性能可移植性需要找到程序在从不同上层应用到不同底层架构的共性与个性。个性体现于领域不同、架构不同，在反映个性的前提下抓住共性，才能得到一个良好的并行计算统一编程模型，而本篇论文的对共性的解释则体现在统一编程抽象中，并且给出了从数据流的角度反映共性的例子。另外，我认为在给出的例子中，模型的调度系统对并行性的探索和分析也是基于上层编程抽象实现的，上层的数据流图已经反映了并行性，调度系统的解析就可以很方便，那么如果上层的编程抽象没有体现并行性的情况下，调度系统能否自己分析出并行性呢？吴树森博士的“并行程序=数据+关联结构+计算”思想也是在提出一种编程抽象，但是我觉得他对于关联结构的描述并不是太优美，感觉可以从关联结构的设计上再做进一步研究。